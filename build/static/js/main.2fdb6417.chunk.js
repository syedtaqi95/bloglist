(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{98:function(e,t,n){},99:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(24),s=n.n(a),i=n(9),u=n(31),o=n(15),l=n(108),d=n(7),j=n.n(d),b=n(10),O=n(27),h=n(104),f=n(101),p=n(1),x=function(e){var t=e.addBlog,n=Object(r.useState)(""),c=Object(O.a)(n,2),a=c[0],s=c[1],i=Object(r.useState)(""),u=Object(O.a)(i,2),o=u[0],l=u[1],d=Object(r.useState)(""),x=Object(O.a)(d,2),v=x[0],g=x[1],m=function(){var e=Object(b.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t({title:a,author:o,url:v}),s(""),l(""),g("");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{children:"create new"}),Object(p.jsxs)(h.a,{onSubmit:m,children:[Object(p.jsxs)(h.a.Group,{children:[Object(p.jsx)(h.a.Label,{children:"Title"}),Object(p.jsx)(h.a.Control,{type:"text",value:a,id:"title",name:"Title",onChange:function(e){var t=e.target;return s(t.value)}})]}),Object(p.jsxs)(h.a.Group,{children:[Object(p.jsx)(h.a.Label,{children:"Author"}),Object(p.jsx)(h.a.Control,{type:"text",value:o,id:"author",name:"Author",onChange:function(e){var t=e.target;return l(t.value)}})]}),Object(p.jsxs)(h.a.Group,{children:[Object(p.jsx)(h.a.Label,{children:"URL"}),Object(p.jsx)(h.a.Control,{type:"text",value:v,id:"url",name:"Url",onChange:function(e){var t=e.target;return g(t.value)}})]}),Object(p.jsx)(f.a,{variant:"info",type:"submit",id:"create-button",children:"create"})]})]})},v=c.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),c=Object(O.a)(n,2),a=c[0],s=c[1],i={display:a?"none":""},u={display:a?"":"none"},o=function(){s(!a)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:o}})),Object(p.jsxs)("div",{style:{marginBottom:5},children:[Object(p.jsx)("div",{style:i,children:Object(p.jsx)(f.a,{variant:"info",onClick:o,children:e.buttonLabel})}),Object(p.jsxs)("div",{style:u,children:[e.children,Object(p.jsx)(f.a,{variant:"secondary",onClick:o,children:"cancel"})]})]})}));v.displayName="Togglable";var g,m=v,y=n(8),w=n(22),k=n(20),T=n.n(k),S="/api/blogs",L=null,E={getAll:function(){return T.a.get(S).then((function(e){return e.data}))},setToken:function(e){L="bearer ".concat(e)},create:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:L}},e.next=3,T.a.post(S,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(S,"/").concat(t.id),e.next=3,T.a.put(n,t);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(S,"/").concat(t.id),r={headers:{Authorization:L}},e.next=4,T.a.delete(n,r);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),comment:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(S,"/").concat(n,"/comments"),e.next=3,T.a.post(r,{comment:t});case 3:return c=e.sent,e.abrupt("return",c.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},I={message:null,messageType:null},C=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return function(){var r=Object(b.a)(j.a.mark((function r(c){return j.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:c({type:"SET_NOTIFICATION",messageObject:{message:e,messageType:t}}),clearTimeout(g),g=setTimeout((function(){return c(N())}),1e3*n);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},N=function(){return{type:"CLEAR_NOTIFICATION"}},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.messageObject;case"CLEAR_NOTIFICATION":return I;default:return e}},A={getAll:function(){return T.a.get("/api/users").then((function(e){return e.data}))}},D=function(){return function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getAll();case 2:n=e.sent,t({type:"UPDATE_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_USERS":return t.data;default:return e}},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"ADD_BLOG":return[].concat(Object(u.a)(e),[t.data]);case"UPDATE_BLOG":var n=t.data,r=n.id;return e.map((function(e){return e.id===r?n:e}));case"DELETE_BLOG":var c=t.data;return e.filter((function(e){return e.id!==c.id}));default:return e}},G=function(){var e=Object(y.c)((function(e){return e.blogs})),t=Object(y.b)(),n=Object(r.useRef)();return Object(p.jsxs)("div",{children:[Object(p.jsx)("br",{}),Object(p.jsx)(m,{buttonLabel:"create new blog",ref:n,children:Object(p.jsx)(x,{addBlog:function(e){var r;n.current.toggleVisibility(),t((r=e,function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.create(r);case 3:n=e.sent,t({type:"ADD_BLOG",data:n}),t(D()),t(C('added "'.concat(r.title,'" by ').concat(r.author),"success")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t(C('Failed to add "'.concat(r.title,'" by ').concat(r.author),"danger"));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()))}})}),Object(u.a)(e).sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(p.jsx)(l.a,{body:!0,children:Object(p.jsx)(o.Link,{to:"/blogs/".concat(e.id),children:Object(p.jsxs)("strong",{className:"text-dark",children:[e.title," - ",e.author]})})},e.id)}))]})},R=n(106),P=function(){var e=Object(y.c)((function(e){return e.notification}));return null!==e.message?Object(p.jsx)(R.a,{variant:e.messageType,children:e.message}):null},F={login:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},J={username:"",password:"",loggedInUser:null},M=function(e){return{type:"SET_USERNAME",data:e}},V=function(e){return{type:"SET_PASSWORD",data:e}},W=function(e){return window.localStorage.setItem("loggedInUser",JSON.stringify(e)),E.setToken(e.token),{type:"SET_LOGGEDINUSER",data:e}},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERNAME":return Object(w.a)(Object(w.a)({},e),{},{username:t.data});case"SET_PASSWORD":return Object(w.a)(Object(w.a)({},e),{},{password:t.data});case"SET_LOGGEDINUSER":return Object(w.a)(Object(w.a)({},e),{},{loggedInUser:t.data});case"LOGOUT":return J;default:return e}},H=function(){var e=Object(y.b)(),t=Object(y.c)((function(e){return e.user.username})),n=Object(y.c)((function(e){return e.user.password})),r=Object(i.k)();return Object(p.jsxs)("div",{children:[Object(p.jsx)("h2",{children:"Log in to application"}),Object(p.jsx)(P,{}),Object(p.jsxs)(h.a,{onSubmit:function(c){c.preventDefault(),e(function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var c;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,F.login({username:e,password:t});case 3:c=n.sent,r(W(c)),r(M("")),r(V("")),r(N()),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),console.log(n.t0),r(C("wrong username or password","danger"));case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()}(t,n)),r.push("/")},children:[Object(p.jsxs)(h.a.Group,{children:[Object(p.jsx)(h.a.Label,{children:"Username"}),Object(p.jsx)(h.a.Control,{type:"text",id:"username",value:t,name:"Username",onChange:function(t){var n=t.target;return e(M(n.value))}})]}),Object(p.jsxs)(h.a.Group,{children:[Object(p.jsx)(h.a.Label,{children:"Password"}),Object(p.jsx)(h.a.Control,{type:"password",id:"password",value:n,name:"Password",onChange:function(t){var n=t.target;return e(V(n.value))},autoComplete:"current-password"})]}),Object(p.jsx)(f.a,{variant:"info",type:"submit",id:"login-button",children:"login"})]})]})},q=n(105),K=n(107),Q=n(47),X=function(){var e=Object(y.c)((function(e){return e.user.loggedInUser})),t=Object(y.b)(),n=Object(i.k)(),r={marginLeft:5,marginRight:5};return Object(p.jsxs)("div",{children:[Object(p.jsxs)(q.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark",children:[Object(p.jsx)(q.a.Brand,{children:Object(p.jsx)(Q.LinkContainer,{className:"text-info",to:"/",children:Object(p.jsx)(K.a.Link,{children:"Blog App"})})}),Object(p.jsx)(q.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(p.jsx)(q.a.Collapse,{id:"responsive-navbar-nav",children:Object(p.jsxs)(K.a,{className:"mr-auto",children:[Object(p.jsx)(Q.LinkContainer,{style:r,to:"/",children:Object(p.jsx)(K.a.Link,{children:"Blogs"})}),Object(p.jsx)(Q.LinkContainer,{style:r,to:"/users",children:Object(p.jsx)(K.a.Link,{children:"Users"})}),Object(p.jsxs)(q.a.Text,{style:r,className:"text-info",children:[e.name," logged in"]}),Object(p.jsx)(f.a,{variant:"outline-info",type:"submit",onClick:function(e){e.preventDefault(),t((function(e){E.setToken(null),window.localStorage.removeItem("loggedInUser"),e(C("logged out","success")),e({type:"LOGOUT"})})),n.push("/")},children:"logout"})]})})]}),Object(p.jsx)(P,{})]})},Y=n(102),Z=function(){var e=Object(y.c)((function(e){return e.users}));return Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{children:"Users"}),Object(p.jsxs)(Y.a,{striped:!0,children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{}),Object(p.jsx)("th",{children:"Blogs created"})]})}),Object(p.jsx)("tbody",{children:Object(u.a)(e).map((function(e){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:Object(p.jsx)(o.Link,{to:"/users/".concat(e.id),children:Object(p.jsx)("strong",{className:"text-dark",children:e.name})})}),Object(p.jsx)("td",{children:e.blogs.length})]},e.id)}))})]})]})},$=n(109),ee=function(){var e=Object(y.c)((function(e){return e.users})),t=Object(i.n)("/users/:id"),n=t?e.find((function(e){return e.id===t.params.id})):null;return n?Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{children:n.name}),Object(p.jsx)("h4",{children:"added blogs"}),Object(p.jsx)($.a,{children:n.blogs.map((function(e){return Object(p.jsx)($.a.Item,{children:Object(p.jsx)(o.Link,{to:"/blogs/".concat(e.id),children:Object(p.jsx)("strong",{className:"text-dark",children:e.title})})},e.id)}))})]}):null},te=n(103),ne=n(62),re=function(){var e=Object(r.useState)(""),t=Object(O.a)(e,2),n=t[0],c=t[1],a=Object(y.c)((function(e){return e.blogs})),s=Object(y.c)((function(e){return e.user.loggedInUser})),u=Object(y.b)(),o=Object(i.k)(),l=Object(i.n)("/blogs/:id"),d=l?a.find((function(e){return e.id===l.params.id})):null;if(!d)return null;var x=function(e){u(function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){var r,c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=Object(w.a)(Object(w.a)({},e),{},{user:e.user.id,likes:e.likes+1}),t.next=4,E.update(r);case 4:c=t.sent,n({type:"UPDATE_BLOG",data:c}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(C('Failed to like "'.concat(e.title,'" by ').concat(e.author),"danger"));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(e))},v=function(e){var t="Remove blog '".concat(e.title,"' by ").concat(e.author,"?");window.confirm(t)&&(u(function(e){return function(){var t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E.remove(e);case 3:n({type:"DELETE_BLOG",data:e}),n(D()),n(C('Deleted "'.concat(e.title,'" by ').concat(e.author),"success")),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(C('Failed to delete "'.concat(e.title,'" by ').concat(e.author),"danger"));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(e)),o.push("/"))};return Object(p.jsxs)("div",{className:"blogDetailedView",children:[Object(p.jsxs)("h3",{children:[d.title," - ",d.author]}),Object(p.jsx)("a",{className:"urlDiv",href:"https://".concat(d.url),children:d.url}),Object(p.jsxs)("div",{className:"likesDiv",children:["likes ",d.likes,Object(p.jsx)(f.a,{variant:"info",onClick:function(){return x(d)},className:"likeButton",children:"like"})]}),Object(p.jsxs)("div",{children:["added by ",d.user.name]}),Object(p.jsx)("div",{style:{display:d.user.id===s.id?"":"none"},children:Object(p.jsx)(f.a,{variant:"info",onClick:function(){return v(d)},className:"removeButton",children:"remove"})}),Object(p.jsx)("h3",{children:"comments"}),Object(p.jsx)(h.a,{onSubmit:function(e){e.preventDefault(),u(function(e,t){return function(){var n=Object(b.a)(j.a.mark((function n(r){var c;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,E.comment(e,t.id);case 3:c=n.sent,r({type:"UPDATE_BLOG",data:c}),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),r(C("Failed to comment on ".concat(t.title),"danger"));case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}()}(n,d)),c("")},children:Object(p.jsxs)(te.a,{children:[Object(p.jsx)(ne.a,{children:Object(p.jsx)(h.a.Control,{type:"text",value:n,id:"comment",name:"Comment",onChange:function(e){var t=e.target;return c(t.value)}})}),Object(p.jsx)(ne.a,{children:Object(p.jsx)(f.a,{variant:"info",type:"submit",children:"add comment"})})]})}),Object(p.jsx)("br",{}),Object(p.jsx)($.a,{children:d.comments.map((function(e){return Object(p.jsx)($.a.Item,{children:e},e)}))})]})},ce=function(){var e=Object(y.b)(),t=Object(y.c)((function(e){return e.user.loggedInUser}));return Object(r.useEffect)((function(){return e(function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(r.useEffect)((function(){return e(D())}),[]),Object(r.useEffect)((function(){var t=window.localStorage.getItem("loggedInUser");if(t){var n=JSON.parse(t);e(W(n))}}),[]),Object(p.jsx)("div",{className:"container bg-light",children:null===t?Object(p.jsx)(H,{}):Object(p.jsxs)("div",{children:[Object(p.jsx)(X,{}),Object(p.jsxs)(i.g,{children:[Object(p.jsx)(i.d,{path:"/users/:id",children:Object(p.jsx)(ee,{})}),Object(p.jsx)(i.d,{path:"/users",children:Object(p.jsx)(Z,{})}),Object(p.jsx)(i.d,{path:"/blogs/:id",children:Object(p.jsx)(re,{})}),Object(p.jsx)(i.d,{path:"/",children:Object(p.jsx)(G,{})})]})]})})},ae=(n(98),n(36)),se=n(65),ie=n(66),ue=Object(ae.combineReducers)({notification:U,blogs:B,user:z,users:_}),oe=Object(ae.createStore)(ue,Object(se.composeWithDevTools)(Object(ae.applyMiddleware)(ie.a)));s.a.render(Object(p.jsx)(y.a,{store:oe,children:Object(p.jsx)(o.BrowserRouter,{children:Object(p.jsx)(ce,{})})}),document.getElementById("root"))}},[[99,1,2]]]);
//# sourceMappingURL=main.2fdb6417.chunk.js.map